/*C11*/SET SCHEMA PUBLIC
drop table company if exists
drop table image if exists
drop table product if exists
drop table sale if exists
drop table user if exists
drop table user_targeting_company if exists
create table company (id bigint generated by default as identity (start with 1), address varchar(255), capital double not null, category varchar(255), company_name varchar(255), postal_code varchar(255), profit double not null, revenue double not null, primary key (id))
create table image (id bigint generated by default as identity (start with 1), date_created timestamp, descript varchar(255), file_name varchar(255), folder varchar(255), img_name varchar(255), product_id bigint, primary key (id))
create table product (id bigint generated by default as identity (start with 1), price double not null, prod_attrs varbinary(255), prod_category varchar(255), prod_id varchar(255), prod_name varchar(255), stock integer not null, company_id bigint, primary key (id))
create table sale (id bigint generated by default as identity (start with 1), date timestamp, descript varchar(255), discount double not null, price double not null, quantity integer not null, sale_category varchar(255), sale_name varchar(255), total double not null, buyer_id bigint, owner_id bigint, product_id bigint, primary key (id))
create table user (id bigint generated by default as identity (start with 1), confirmed boolean not null, email varchar(255) not null, full_name varchar(255), is_owner boolean not null, password varchar(255), user_name varchar(255) not null, company_id bigint, primary key (id))
create table user_targeting_company (targeted_user_list_id bigint not null, targeting_company_id bigint not null, primary key (targeted_user_list_id, targeting_company_id))
alter table company add constraint UKh7w1mkrsh1wcg5dkv6wrvam5m unique (company_name)
alter table user add constraint UKf9dvvibvpfsldnu8wh3enop4i unique (user_name, email)
alter table image add constraint FKgpextbyee3uk9u6o2381m7ft1 foreign key (product_id) references product
alter table product add constraint FKghawd5rtv8ok565nwpdyyuto9 foreign key (company_id) references company
alter table sale add constraint FK7kf4xoa8lwqe3xxy8v8fpxldl foreign key (buyer_id) references user
alter table sale add constraint FKqir89q1x2782s1l5yh7ewg4gr foreign key (owner_id) references user
alter table sale add constraint FKonrcqwf09u6spb6ty6sh11jh5 foreign key (product_id) references product
alter table user add constraint FK2yuxsfrkkrnkn5emoobcnnc3r foreign key (company_id) references company
alter table user_targeting_company add constraint FK4h7wfe4aphl2r5g4rrauufxge foreign key (targeting_company_id) references company
alter table user_targeting_company add constraint FKa7k9swauk58fbnw95hxvt9w3f foreign key (targeted_user_list_id) references user
INSERT INTO COMPANY VALUES(1,'NTU',0.0E0,'Books','BookStore','637720',0.0E0,0.0E0)
INSERT INTO COMPANY VALUES(2,'NTU',0.0E0,'Foods','FootHunt','637720',0.0E0,0.0E0)
COMMIT
INSERT INTO USER VALUES(1,TRUE,'beckham101@gmail.com','David Beckham',FALSE,'123123123','beckham101',1)
INSERT INTO USER VALUES(2,TRUE,'fifi@e.ntu.edu.sg','fi fi',FALSE,'123123123','xuanphi001',1)
INSERT INTO USER VALUES(3,TRUE,'david@gmail.com','John david',FALSE,'123456','david',NULL)
INSERT INTO USER VALUES(4,TRUE,'lara@gmail.com','lara croft',FALSE,'123456','lara',NULL)
COMMIT
INSERT INTO PRODUCT VALUES(1,12.2E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_1','Quantum Physics',20,1)
INSERT INTO PRODUCT VALUES(2,30.2E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_2','Computer science',22,1)
INSERT INTO PRODUCT VALUES(3,22.3E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_3','Literature',10,1)
INSERT INTO PRODUCT VALUES(4,50.99E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_4','Algorithm',20,1)
INSERT INTO PRODUCT VALUES(5,5.0E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_5','Mathematics',70,1)
INSERT INTO PRODUCT VALUES(6,30.1E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','science','prod_6','Economics',2,1)
INSERT INTO PRODUCT VALUES(7,42.4E0,'aced0005737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f400000000000007708000000100000000078','Business','prod_7','Bussiness',9,1)
COMMIT
INSERT INTO SALE VALUES(1,'2017-05-13 13:21:17.842000','David buy',0.0E0,30.2E0,5,'Online','',151.0E0,3,NULL,2)
INSERT INTO SALE VALUES(2,'2017-05-13 13:21:17.842000','David buy',0.0E0,22.3E0,10,'Online','',223.0E0,3,NULL,3)
INSERT INTO SALE VALUES(3,'2017-05-13 13:21:17.842000','David buy',0.0E0,50.99E0,1,'Online','',50.99E0,3,NULL,4)
INSERT INTO SALE VALUES(4,'2017-05-13 13:21:17.842000','David buy',0.0E0,30.1E0,2,'Online','',60.2E0,3,NULL,6)
INSERT INTO SALE VALUES(5,'2017-05-13 13:21:17.842000','David buy',0.0E0,12.2E0,4,'Online','',48.8E0,3,NULL,1)
INSERT INTO SALE VALUES(6,'2017-05-13 13:21:17.843000','David buy',0.0E0,5.0E0,9,'Online','',45.0E0,3,NULL,5)
INSERT INTO SALE VALUES(7,'2017-05-13 13:21:17.843000','David buy',0.0E0,42.4E0,4,'Online','',169.6E0,3,NULL,7)
COMMIT
